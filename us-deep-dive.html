<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>US Maternal Mortality Deep Dive | 2023-2024</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://unpkg.com/topojson-client@3"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Inter', -apple-system, sans-serif;
      background: #f0f0f0;
      color: #222;
      line-height: 1.6;
    }
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: #fff;
    }
    .header {
      background: #222;
      color: white;
      padding: 40px 48px 36px;
    }
    .back-link {
      display: inline-block;
      color: rgba(255,255,255,0.6);
      text-decoration: none;
      font-size: 12px;
      font-family: 'Roboto Mono', monospace;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .back-link:hover { color: white; }
    .kicker {
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: #ff6b6b;
      margin-bottom: 8px;
      font-family: 'Roboto Mono', monospace;
    }
    h1 {
      font-size: 38px;
      font-weight: 900;
      line-height: 1.05;
      margin-bottom: 12px;
      letter-spacing: -1px;
    }
    .subtitle {
      font-size: 17px;
      font-weight: 400;
      opacity: 0.85;
      max-width: 600px;
      line-height: 1.5;
    }
    .section {
      padding: 40px 48px;
      border-bottom: 1px solid #e0e0e0;
    }
    .section-title {
      font-size: 20px;
      font-weight: 800;
      margin-bottom: 6px;
      color: #222;
    }
    .section-desc {
      font-size: 14px;
      color: #666;
      margin-bottom: 20px;
      max-width: 650px;
    }
    
    /* Map Styles */
    .map-container {
      position: relative;
      background: #fafafa;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    #map {
      width: 100%;
      height: 500px;
    }
    .state {
      stroke: #fff;
      stroke-width: 1px;
      cursor: pointer;
      transition: opacity 0.15s;
    }
    .state:hover {
      opacity: 0.8;
      stroke: #222;
      stroke-width: 2px;
    }
    .county {
      stroke: rgba(255,255,255,0.3);
      stroke-width: 0.25px;
      cursor: pointer;
    }
    .county:hover {
      stroke: #222;
      stroke-width: 1px;
    }
    .tooltip {
      position: absolute;
      background: #222;
      color: white;
      padding: 12px 16px;
      border-radius: 6px;
      font-size: 13px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.15s;
      z-index: 100;
      max-width: 250px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .tooltip.visible { opacity: 1; }
    .tooltip-title {
      font-weight: 700;
      font-size: 14px;
      margin-bottom: 4px;
    }
    .tooltip-value {
      font-family: 'Roboto Mono', monospace;
      font-size: 18px;
      font-weight: 700;
      color: #ff6b6b;
    }
    .tooltip-label {
      font-size: 11px;
      opacity: 0.7;
    }
    
    /* Legend */
    .legend {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 16px;
      flex-wrap: wrap;
    }
    .legend-title {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #666;
      margin-right: 8px;
    }
    .legend-scale {
      display: flex;
      height: 12px;
      border-radius: 2px;
      overflow: hidden;
    }
    .legend-scale div {
      width: 40px;
      height: 100%;
    }
    .legend-labels {
      display: flex;
      font-size: 10px;
      font-family: 'Roboto Mono', monospace;
      color: #888;
      margin-top: 4px;
    }
    .legend-labels span {
      width: 40px;
      text-align: center;
    }
    
    /* Map Toggle */
    .map-toggle {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }
    .map-toggle button {
      padding: 8px 16px;
      border: 2px solid #ddd;
      background: white;
      font-family: 'Roboto Mono', monospace;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      cursor: pointer;
      border-radius: 4px;
      transition: all 0.15s;
    }
    .map-toggle button:hover {
      border-color: #aaa;
    }
    .map-toggle button.active {
      background: #222;
      color: white;
      border-color: #222;
    }
    
    /* Big Numbers */
    .big-number-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1px;
      background: #e0e0e0;
      margin: 24px 0;
    }
    .big-number {
      background: #fafafa;
      padding: 24px 16px;
      text-align: center;
    }
    .big-number-value {
      font-size: 36px;
      font-weight: 900;
      font-family: 'Roboto Mono', monospace;
      line-height: 1;
    }
    .big-number-value.red { color: #e63946; }
    .big-number-value.green { color: #2a9d8f; }
    .big-number-value.blue { color: #457b9d; }
    .big-number-label {
      font-size: 10px;
      color: #666;
      margin-top: 6px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    /* Annotation */
    .annotation {
      background: #fffbeb;
      border-left: 4px solid #f59e0b;
      padding: 16px 20px;
      margin: 20px 0;
      font-size: 14px;
    }
    .annotation strong { color: #b45309; }
    .annotation-red {
      background: #fef2f2;
      border-left-color: #e63946;
    }
    .annotation-red strong { color: #c62828; }
    
    /* Chart container */
    .chart-container {
      position: relative;
      margin: 20px 0;
    }
    .chart-title {
      font-family: 'Roboto Mono', monospace;
      font-size: 12px;
      font-weight: 600;
      color: #222;
      margin-bottom: 4px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .chart-subtitle {
      font-size: 12px;
      color: #888;
      margin-bottom: 12px;
    }
    
    /* Race bars */
    .race-bar-chart {
      margin: 20px 0;
    }
    .race-row {
      display: flex;
      align-items: center;
      margin: 12px 0;
    }
    .race-label {
      width: 80px;
      font-size: 13px;
      font-weight: 600;
    }
    .race-bar-container {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .race-bar {
      height: 28px;
      border-radius: 3px;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 8px;
      min-width: 40px;
    }
    .race-bar-value {
      font-family: 'Roboto Mono', monospace;
      font-size: 12px;
      font-weight: 600;
      color: white;
    }
    .race-change {
      font-family: 'Roboto Mono', monospace;
      font-size: 11px;
      font-weight: 600;
      padding: 2px 6px;
      border-radius: 3px;
    }
    .race-change.up { background: #fef2f2; color: #e63946; }
    .race-change.down { background: #f0fdf4; color: #2a9d8f; }
    
    /* State ranking */
    .state-ranking {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin: 20px 0;
    }
    .state-rank-item {
      display: flex;
      align-items: center;
      padding: 12px;
      background: #fafafa;
      border-radius: 6px;
      gap: 12px;
    }
    .state-rank-num {
      font-family: 'Roboto Mono', monospace;
      font-size: 11px;
      font-weight: 600;
      color: #888;
      width: 24px;
    }
    .state-rank-bar {
      flex: 1;
      height: 8px;
      background: #e8e8e8;
      border-radius: 4px;
      overflow: hidden;
    }
    .state-rank-fill {
      height: 100%;
      border-radius: 4px;
    }
    .state-rank-name {
      font-size: 12px;
      font-weight: 600;
      width: 90px;
    }
    .state-rank-value {
      font-family: 'Roboto Mono', monospace;
      font-size: 13px;
      font-weight: 700;
      width: 40px;
      text-align: right;
    }
    
    .sources {
      background: #fafafa;
      padding: 28px 48px;
      font-size: 11px;
      color: #888;
    }
    .sources h3 {
      font-family: 'Roboto Mono', monospace;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
      color: #666;
    }
    .sources a {
      color: #457b9d;
      text-decoration: none;
    }
    .sources a:hover { text-decoration: underline; }
    .footer {
      padding: 20px 48px;
      font-size: 10px;
      color: #aaa;
      text-align: center;
      font-family: 'Roboto Mono', monospace;
    }
    @media (max-width: 768px) {
      .header, .section, .sources { padding-left: 24px; padding-right: 24px; }
      h1 { font-size: 28px; }
      .big-number-grid { grid-template-columns: repeat(2, 1fr); }
      .state-ranking { grid-template-columns: 1fr; }
      #map { height: 350px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <a href="index.html" class="back-link">← Back to Global</a>
      <div class="kicker">United States</div>
      <h1>Maternal Mortality in America</h1>
      <div class="subtitle">An interactive look at where mothers are dying — and why the U.S. is an outlier among wealthy nations.</div>
    </div>

    <div class="section">
      <div class="big-number-grid">
        <div class="big-number">
          <div class="big-number-value red">669</div>
          <div class="big-number-label">Deaths in 2023</div>
        </div>
        <div class="big-number">
          <div class="big-number-value blue">18.6</div>
          <div class="big-number-label">Per 100K births</div>
        </div>
        <div class="big-number">
          <div class="big-number-value red">80%</div>
          <div class="big-number-label">Preventable</div>
        </div>
        <div class="big-number">
          <div class="big-number-value green">−44%</div>
          <div class="big-number-label">Since 2021</div>
        </div>
      </div>
    </div>

    <div class="section">
      <div class="section-title">Maternal Mortality by State</div>
      <div class="section-desc">Hover over any state to see its maternal mortality rate. The gap between best and worst states is more than 4×.</div>
      
      <div class="map-container">
        <div id="map"></div>
        <div class="tooltip" id="tooltip"></div>
        <div class="legend">
          <span class="legend-title">Deaths per 100K births:</span>
          <div>
            <div class="legend-scale">
              <div style="background:#fee5d9"></div>
              <div style="background:#fcae91"></div>
              <div style="background:#fb6a4a"></div>
              <div style="background:#de2d26"></div>
              <div style="background:#a50f15"></div>
            </div>
            <div class="legend-labels">
              <span>10</span>
              <span>20</span>
              <span>30</span>
              <span>40</span>
              <span>50+</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="annotation">
        <strong>California has invested heavily in maternal health</strong> — establishing review committees, quality improvement programs, and expanded Medicaid coverage. The result: a rate (10.1) that's 4× lower than Tennessee (42.1).
      </div>
    </div>

    <div class="section">
      <div class="section-title">State Rankings</div>
      <div class="section-desc">Maternal mortality rate, 2019–2023 average. States with small numbers suppressed.</div>
      
      <div class="state-ranking" id="stateRanking"></div>
    </div>

    <div class="section">
      <div class="section-title">The Racial Divide</div>
      <div class="section-desc">Black women face 3.5× the risk of white women — a gap that persists across income and education levels.</div>
      
      <div class="chart-title">Maternal mortality by race, 2023</div>
      <div class="chart-subtitle">Deaths per 100,000 live births, with year-over-year change</div>
      
      <div class="race-bar-chart" id="raceChart"></div>
      
      <div class="annotation-red annotation">
        <strong>Black maternal mortality actually increased in 2023</strong> (+1.6%) while all other groups saw declines. Hispanic women saw the largest drop (−26.6%).
      </div>
    </div>

    <div class="section">
      <div class="section-title">What's Killing Mothers?</div>
      <div class="section-desc">Leading causes of maternal death, 2020–2023.</div>
      
      <div class="chart-container" style="height: 280px;">
        <canvas id="causesChart"></canvas>
      </div>
    </div>

    <div class="section">
      <div class="section-title">The COVID Spike</div>
      <div class="section-desc">Maternal mortality spiked dramatically in 2021 when COVID-19 became the leading cause of maternal death.</div>
      
      <div class="chart-container" style="height: 280px;">
        <canvas id="trendChart"></canvas>
      </div>
    </div>

    <div class="section">
      <div class="section-title">Maternity Care Deserts</div>
      <div class="section-desc">35% of U.S. counties have no obstetric care — no hospitals, no birth centers, no OB-GYNs.</div>
      
      <div class="big-number-grid">
        <div class="big-number">
          <div class="big-number-value red">35%</div>
          <div class="big-number-label">Counties are deserts</div>
        </div>
        <div class="big-number">
          <div class="big-number-value red">2.2M</div>
          <div class="big-number-label">Women affected</div>
        </div>
        <div class="big-number">
          <div class="big-number-value blue">8K</div>
          <div class="big-number-label">More OB-GYNs needed</div>
        </div>
        <div class="big-number">
          <div class="big-number-value red">52%</div>
          <div class="big-number-label">Counties lack OB hospital</div>
        </div>
      </div>
    </div>

    <div class="sources">
      <h3>Sources</h3>
      <a href="https://www.cdc.gov/nchs/maternal-mortality/" target="_blank">CDC NCHS Maternal Mortality</a> · 
      <a href="https://usafacts.org/articles/which-states-have-the-highest-maternal-mortality-rates/" target="_blank">USAFacts</a> · 
      <a href="https://www.marchofdimes.org/maternity-care-deserts-report" target="_blank">March of Dimes</a> · 
      <a href="https://www.commonwealthfund.org/" target="_blank">Commonwealth Fund</a>
    </div>

    <div class="footer">
      MATERNAL MORTALITY RATIO = DEATHS PER 100,000 LIVE BIRTHS
    </div>
  </div>

  <script>
    // State data
    const stateData = {
      'Tennessee': 42.1, 'Louisiana': 40.7, 'Mississippi': 39.7, 'Arkansas': 37.2,
      'Alabama': 36.5, 'Georgia': 33.9, 'Indiana': 32.1, 'Missouri': 28.5,
      'South Carolina': 27.8, 'Kentucky': 26.3, 'Ohio': 25.3, 'Texas': 24.8,
      'Oklahoma': 24.1, 'Nevada': 23.5, 'Florida': 22.1, 'Arizona': 21.8,
      'North Carolina': 21.2, 'New York': 20.3, 'Michigan': 19.8, 'Illinois': 19.2,
      'Pennsylvania': 18.9, 'New Jersey': 18.6, 'Virginia': 17.3, 'Maryland': 16.8,
      'Colorado': 16.2, 'Washington': 15.2, 'Oregon': 14.8, 'Minnesota': 14.1,
      'Massachusetts': 12.8, 'Connecticut': 12.1, 'California': 10.1
    };

    // Color scale
    const colorScale = d3.scaleThreshold()
      .domain([15, 20, 25, 30, 40])
      .range(['#fee5d9', '#fcae91', '#fb6a4a', '#de2d26', '#a50f15', '#67000d']);

    // Load and render map
    const width = 900, height = 500;
    const svg = d3.select('#map')
      .append('svg')
      .attr('viewBox', `0 0 ${width} ${height}`)
      .attr('preserveAspectRatio', 'xMidYMid meet');

    const tooltip = d3.select('#tooltip');

    d3.json('https://cdn.jsdelivr.net/npm/us-atlas@3/states-10m.json').then(us => {
      const projection = d3.geoAlbersUsa().fitSize([width, height], topojson.feature(us, us.objects.states));
      const path = d3.geoPath().projection(projection);

      svg.selectAll('path')
        .data(topojson.feature(us, us.objects.states).features)
        .enter()
        .append('path')
        .attr('class', 'state')
        .attr('d', path)
        .attr('fill', d => {
          const name = d.properties.name;
          const rate = stateData[name];
          return rate ? colorScale(rate) : '#e8e8e8';
        })
        .on('mousemove', function(event, d) {
          const name = d.properties.name;
          const rate = stateData[name];
          
          tooltip.classed('visible', true)
            .style('left', (event.offsetX + 15) + 'px')
            .style('top', (event.offsetY - 10) + 'px')
            .html(`
              <div class="tooltip-title">${name}</div>
              ${rate ? `
                <div class="tooltip-value">${rate}</div>
                <div class="tooltip-label">deaths per 100K births</div>
              ` : '<div class="tooltip-label">Data not available</div>'}
            `);
        })
        .on('mouseout', () => tooltip.classed('visible', false));
    });

    // State ranking
    const rankingEl = document.getElementById('stateRanking');
    const sortedStates = Object.entries(stateData).sort((a, b) => b[1] - a[1]);
    const maxRate = sortedStates[0][1];

    sortedStates.forEach(([state, rate], i) => {
      const pct = (rate / maxRate) * 100;
      const color = colorScale(rate);
      const item = document.createElement('div');
      item.className = 'state-rank-item';
      item.innerHTML = `
        <span class="state-rank-num">${i + 1}</span>
        <span class="state-rank-name">${state}</span>
        <div class="state-rank-bar">
          <div class="state-rank-fill" style="width:${pct}%;background:${color}"></div>
        </div>
        <span class="state-rank-value" style="color:${color}">${rate}</span>
      `;
      rankingEl.appendChild(item);
    });

    // Race chart
    const raceData = [
      { label: 'Black', value: 50.3, change: '+1.6%', up: true },
      { label: 'White', value: 14.5, change: '−23.7%', up: false },
      { label: 'Hispanic', value: 12.4, change: '−26.6%', up: false },
      { label: 'Asian', value: 10.7, change: '−18.9%', up: false }
    ];

    const raceChartEl = document.getElementById('raceChart');
    const maxRace = 55;

    raceData.forEach(d => {
      const pct = (d.value / maxRace) * 100;
      const color = d.up ? '#e63946' : '#457b9d';
      const row = document.createElement('div');
      row.className = 'race-row';
      row.innerHTML = `
        <span class="race-label">${d.label}</span>
        <div class="race-bar-container">
          <div class="race-bar" style="width:${pct}%;background:${color}">
            <span class="race-bar-value">${d.value}</span>
          </div>
          <span class="race-change ${d.up ? 'up' : 'down'}">${d.change}</span>
        </div>
      `;
      raceChartEl.appendChild(row);
    });

    // Causes chart
    new Chart(document.getElementById('causesChart'), {
      type: 'bar',
      data: {
        labels: ['Hemorrhage', 'Infection', 'Blood Clots', 'Heart Disease', 'Cardiac (other)', 'Other'],
        datasets: [{
          data: [18.1, 14.0, 11.5, 10.2, 10.4, 35.8],
          backgroundColor: ['#e63946', '#f4a261', '#457b9d', '#6d6875', '#aaa', '#ddd'],
          borderRadius: 3
        }]
      },
      options: {
        indexAxis: 'y',
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          x: { max: 40, grid: { color: '#e8e8e8' }, ticks: { callback: v => v + '%', font: { family: 'Roboto Mono', size: 10 } } },
          y: { grid: { display: false }, ticks: { font: { size: 11 } } }
        }
      }
    });

    // Trend chart
    new Chart(document.getElementById('trendChart'), {
      type: 'line',
      data: {
        labels: ['2018', '2019', '2020', '2021', '2022', '2023'],
        datasets: [{
          data: [17.4, 20.1, 23.8, 32.9, 22.3, 18.6],
          borderColor: '#457b9d',
          backgroundColor: 'rgba(69,123,157,0.1)',
          fill: true,
          tension: 0.35,
          pointRadius: 5,
          pointBackgroundColor: ctx => ctx.raw > 30 ? '#e63946' : '#457b9d',
          pointBorderColor: '#fff',
          pointBorderWidth: 2,
          borderWidth: 3
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          y: { min: 10, max: 38, grid: { color: '#e8e8e8' }, ticks: { font: { family: 'Roboto Mono', size: 10 } } },
          x: { grid: { display: false }, ticks: { font: { family: 'Roboto Mono', size: 11, weight: 600 } } }
        }
      }
    });
  </script>
</body>
</html>
